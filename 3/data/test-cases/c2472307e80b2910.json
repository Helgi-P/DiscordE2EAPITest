{"uid":"c2472307e80b2910","name":"test_large_message[1286673475565518878]","fullName":"test_DiscordAPI#test_large_message","historyId":"41082e1008df5f5334e982871e3cece4","time":{"start":1730135300353,"stop":1730135300440,"duration":87},"status":"failed","statusMessage":"AssertionError: Тест упал: сообщение длиной 2000 символов не отправлено.","statusTrace":"base_url = 'https://discord.com/api/v10', headers = {'Authorization': None}\nchannel_id = '1286673475565518878', file_path = None\n\n    def send_message_3_3(base_url, headers, channel_id, file_path=None):\n        message_data = {\"content\": Message_3_3}\n    \n        message_length = len(Message_3_3)\n    \n        with allure.step(f\"Проверка длины сообщения перед отправкой: {message_length} знаков\"):\n            allure.attach(f\"Длина сообщения: {message_length}\", name=\"Message Length\",\n                          attachment_type=allure.attachment_type.TEXT)\n    \n        try:\n>           response = create_message(base_url, headers, channel_id, message_data, file_path)\n\ncreate_message.py:174: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nbase_url = 'https://discord.com/api/v10', headers = {'Authorization': None}\nchannel_id = '1286673475565518878'\nmessage_data = {'content': 'Родные Мягколапа,  зайца из семьи Лесных, были в отчаянии, когда их пушистый друг не вернулся с прогулки ... смотрел, удерживая его под полным контролем. С последним шагом человек исчез под водой, поглощенный болотом AHAHAHAH'}\nfile_path = None\n\n    def create_message(base_url, headers, channel_id, message_data, file_path=None):\n        url = f\"{base_url}/channels/{channel_id}/messages\"\n        print(f\"URL: {url}\")\n    \n        with allure.step(\"Отправка POST-запроса\"):\n    \n            form_data = {\n                'content': message_data['content'],\n            }\n    \n            print(f\"Form data: {form_data}\")\n    \n            files = {}  # Словарь для файлов\n    \n            if file_path:\n                with open(file_path, 'rb') as f:\n                    files['file'] = f\n                    print(f\"Sending file: {file_path}\")\n    \n                    # Отправляем запрос с файлом\n                    response = requests.post(url, headers=headers, data=form_data, files=files)\n            else:\n                # Отправка без файла\n                print(\"Sending without file\")\n                response = requests.post(url, headers=headers, data=form_data)\n    \n            print(f\"Response Status Code: {response.status_code}\")\n            print(f\"Response Text: {response.text}\")\n    \n            allure.attach(str(response.status_code), name=\"HTTP Status Code\", attachment_type=allure.attachment_type.TEXT)\n    \n        with allure.step(\"Проверка кода ответа\"):\n>           assert response.status_code == 200, f\"Expected 200, got {response.status_code}. Response: {response.text}\"\nE           AssertionError: Expected 200, got 401. Response: {\"message\": \"401: Unauthorized\", \"code\": 0}\n\ncreate_message.py:76: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nbase_url = 'https://discord.com/api/v10', headers = {'Authorization': None}\nchannel_id = '1286673475565518878'\nemojis = {'emoji_name_1': '\uD83D\uDE31', 'emoji_name_2': '\uD83D\uDC79', 'emoji_name_3': '\uD83D\uDC80', 'emoji_name_zaika': '\uD83D\uDC07'}\nuser_id = '1286609819137998883'\n\n    @allure.story('Отправка большого сообщения')\n    @pytest.mark.order(4)\n    def test_large_message(base_url, headers, channel_id, emojis, user_id):\n        global message_3_3_id\n    \n        with allure.step('Отправка сообщения Message_3_3'):\n>           message_3_3_id = send_message_3_3(base_url, headers, channel_id)\n\ntest_DiscordAPI.py:164: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nbase_url = 'https://discord.com/api/v10', headers = {'Authorization': None}\nchannel_id = '1286673475565518878', file_path = None\n\n    def send_message_3_3(base_url, headers, channel_id, file_path=None):\n        message_data = {\"content\": Message_3_3}\n    \n        message_length = len(Message_3_3)\n    \n        with allure.step(f\"Проверка длины сообщения перед отправкой: {message_length} знаков\"):\n            allure.attach(f\"Длина сообщения: {message_length}\", name=\"Message Length\",\n                          attachment_type=allure.attachment_type.TEXT)\n    \n        try:\n            response = create_message(base_url, headers, channel_id, message_data, file_path)\n    \n            with allure.step(\"Сообщение успешно отправлено\"):\n                allure.attach(f\"Сообщение успешно отправлено длиной {message_length} знаков.\",\n                              name=\"Успех отправки\", attachment_type=allure.attachment_type.TEXT)\n    \n            return response\n    \n        except AssertionError as e:\n            with allure.step(\"Сообщение не удалось отправить\"):\n                allure.attach(f\"Ошибка: {str(e)}\", name=\"Ошибка отправки\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(f\"Текст сообщения: {Message_3_3}\", name=\"Текст сообщения\",\n                              attachment_type=allure.attachment_type.TEXT)\n    \n            with allure.step(\"Проблема с длиной сообщения\"):\n                max_length = 2000\n                allure.attach(\n                    f\"Ошибка при отправке сообщения длиной {message_length} символов. \"\n                    f\"Ограничение: {max_length} символов.\",\n                    name=\"Возможная проблема\", attachment_type=allure.attachment_type.TEXT)\n    \n            # Выбрасываем ошибку для завершения теста\n>           raise AssertionError(f\"Тест упал: сообщение длиной {message_length} символов не отправлено.\")\nE           AssertionError: Тест упал: сообщение длиной 2000 символов не отправлено.\n\ncreate_message.py:196: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"api_token","time":{"start":1730135300353,"stop":1730135300353,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"headers","time":{"start":1730135300353,"stop":1730135300353,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"user_id","time":{"start":1730135300353,"stop":1730135300353,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"base_url","time":{"start":1730135300353,"stop":1730135300353,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"channel_id","time":{"start":1730135300353,"stop":1730135300353,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"emojis","time":{"start":1730135300353,"stop":1730135300353,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: Тест упал: сообщение длиной 2000 символов не отправлено.","statusTrace":"base_url = 'https://discord.com/api/v10', headers = {'Authorization': None}\nchannel_id = '1286673475565518878', file_path = None\n\n    def send_message_3_3(base_url, headers, channel_id, file_path=None):\n        message_data = {\"content\": Message_3_3}\n    \n        message_length = len(Message_3_3)\n    \n        with allure.step(f\"Проверка длины сообщения перед отправкой: {message_length} знаков\"):\n            allure.attach(f\"Длина сообщения: {message_length}\", name=\"Message Length\",\n                          attachment_type=allure.attachment_type.TEXT)\n    \n        try:\n>           response = create_message(base_url, headers, channel_id, message_data, file_path)\n\ncreate_message.py:174: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nbase_url = 'https://discord.com/api/v10', headers = {'Authorization': None}\nchannel_id = '1286673475565518878'\nmessage_data = {'content': 'Родные Мягколапа,  зайца из семьи Лесных, были в отчаянии, когда их пушистый друг не вернулся с прогулки ... смотрел, удерживая его под полным контролем. С последним шагом человек исчез под водой, поглощенный болотом AHAHAHAH'}\nfile_path = None\n\n    def create_message(base_url, headers, channel_id, message_data, file_path=None):\n        url = f\"{base_url}/channels/{channel_id}/messages\"\n        print(f\"URL: {url}\")\n    \n        with allure.step(\"Отправка POST-запроса\"):\n    \n            form_data = {\n                'content': message_data['content'],\n            }\n    \n            print(f\"Form data: {form_data}\")\n    \n            files = {}  # Словарь для файлов\n    \n            if file_path:\n                with open(file_path, 'rb') as f:\n                    files['file'] = f\n                    print(f\"Sending file: {file_path}\")\n    \n                    # Отправляем запрос с файлом\n                    response = requests.post(url, headers=headers, data=form_data, files=files)\n            else:\n                # Отправка без файла\n                print(\"Sending without file\")\n                response = requests.post(url, headers=headers, data=form_data)\n    \n            print(f\"Response Status Code: {response.status_code}\")\n            print(f\"Response Text: {response.text}\")\n    \n            allure.attach(str(response.status_code), name=\"HTTP Status Code\", attachment_type=allure.attachment_type.TEXT)\n    \n        with allure.step(\"Проверка кода ответа\"):\n>           assert response.status_code == 200, f\"Expected 200, got {response.status_code}. Response: {response.text}\"\nE           AssertionError: Expected 200, got 401. Response: {\"message\": \"401: Unauthorized\", \"code\": 0}\n\ncreate_message.py:76: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nbase_url = 'https://discord.com/api/v10', headers = {'Authorization': None}\nchannel_id = '1286673475565518878'\nemojis = {'emoji_name_1': '\uD83D\uDE31', 'emoji_name_2': '\uD83D\uDC79', 'emoji_name_3': '\uD83D\uDC80', 'emoji_name_zaika': '\uD83D\uDC07'}\nuser_id = '1286609819137998883'\n\n    @allure.story('Отправка большого сообщения')\n    @pytest.mark.order(4)\n    def test_large_message(base_url, headers, channel_id, emojis, user_id):\n        global message_3_3_id\n    \n        with allure.step('Отправка сообщения Message_3_3'):\n>           message_3_3_id = send_message_3_3(base_url, headers, channel_id)\n\ntest_DiscordAPI.py:164: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nbase_url = 'https://discord.com/api/v10', headers = {'Authorization': None}\nchannel_id = '1286673475565518878', file_path = None\n\n    def send_message_3_3(base_url, headers, channel_id, file_path=None):\n        message_data = {\"content\": Message_3_3}\n    \n        message_length = len(Message_3_3)\n    \n        with allure.step(f\"Проверка длины сообщения перед отправкой: {message_length} знаков\"):\n            allure.attach(f\"Длина сообщения: {message_length}\", name=\"Message Length\",\n                          attachment_type=allure.attachment_type.TEXT)\n    \n        try:\n            response = create_message(base_url, headers, channel_id, message_data, file_path)\n    \n            with allure.step(\"Сообщение успешно отправлено\"):\n                allure.attach(f\"Сообщение успешно отправлено длиной {message_length} знаков.\",\n                              name=\"Успех отправки\", attachment_type=allure.attachment_type.TEXT)\n    \n            return response\n    \n        except AssertionError as e:\n            with allure.step(\"Сообщение не удалось отправить\"):\n                allure.attach(f\"Ошибка: {str(e)}\", name=\"Ошибка отправки\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(f\"Текст сообщения: {Message_3_3}\", name=\"Текст сообщения\",\n                              attachment_type=allure.attachment_type.TEXT)\n    \n            with allure.step(\"Проблема с длиной сообщения\"):\n                max_length = 2000\n                allure.attach(\n                    f\"Ошибка при отправке сообщения длиной {message_length} символов. \"\n                    f\"Ограничение: {max_length} символов.\",\n                    name=\"Возможная проблема\", attachment_type=allure.attachment_type.TEXT)\n    \n            # Выбрасываем ошибку для завершения теста\n>           raise AssertionError(f\"Тест упал: сообщение длиной {message_length} символов не отправлено.\")\nE           AssertionError: Тест упал: сообщение длиной 2000 символов не отправлено.\n\ncreate_message.py:196: AssertionError","steps":[{"name":"Отправка сообщения Message_3_3","time":{"start":1730135300354,"stop":1730135300439,"duration":85},"status":"failed","statusMessage":"AssertionError: Тест упал: сообщение длиной 2000 символов не отправлено.\n","statusTrace":"  File \"/home/runner/work/DiscordE2EAPITest/DiscordE2EAPITest/test_DiscordAPI.py\", line 164, in test_large_message\n    message_3_3_id = send_message_3_3(base_url, headers, channel_id)\n  File \"/home/runner/work/DiscordE2EAPITest/DiscordE2EAPITest/create_message.py\", line 196, in send_message_3_3\n    raise AssertionError(f\"Тест упал: сообщение длиной {message_length} символов не отправлено.\")\n","steps":[{"name":"Проверка длины сообщения перед отправкой: 2000 знаков","time":{"start":1730135300354,"stop":1730135300354,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"e22f476987b8bcc4","name":"Message Length","source":"e22f476987b8bcc4.txt","type":"text/plain","size":35}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true},{"name":"Отправка POST-запроса","time":{"start":1730135300354,"stop":1730135300439,"duration":85},"status":"passed","steps":[],"attachments":[{"uid":"6d2a0b547f8df459","name":"HTTP Status Code","source":"6d2a0b547f8df459.txt","type":"text/plain","size":3}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true},{"name":"Проверка кода ответа","time":{"start":1730135300439,"stop":1730135300439,"duration":0},"status":"failed","statusMessage":"AssertionError: Expected 200, got 401. Response: {\"message\": \"401: Unauthorized\", \"code\": 0}\n","statusTrace":"  File \"/home/runner/work/DiscordE2EAPITest/DiscordE2EAPITest/create_message.py\", line 76, in create_message\n    assert response.status_code == 200, f\"Expected 200, got {response.status_code}. Response: {response.text}\"\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true},{"name":"Сообщение не удалось отправить","time":{"start":1730135300439,"stop":1730135300439,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"f9006517ce6a25c1","name":"Ошибка отправки","source":"f9006517ce6a25c1.txt","type":"text/plain","size":90},{"uid":"500f6de93060a42d","name":"Текст сообщения","source":"500f6de93060a42d.txt","type":"text/plain","size":3658}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true},{"name":"Проблема с длиной сообщения","time":{"start":1730135300439,"stop":1730135300439,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"a7fb019a3be271f1","name":"Возможная проблема","source":"a7fb019a3be271f1.txt","type":"text/plain","size":138}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":5,"attachmentsCount":5,"hasContent":true}],"attachments":[{"uid":"892460018ebac6e3","name":"stdout","source":"892460018ebac6e3.txt","type":"text/plain","size":3831}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":6,"attachmentsCount":6,"hasContent":true},"afterStages":[],"labels":[{"name":"story","value":"Отправка большого сообщения"},{"name":"tag","value":"order(4)"},{"name":"suite","value":"test_DiscordAPI"},{"name":"host","value":"fv-az702-985"},{"name":"thread","value":"2081-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"test_DiscordAPI"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"channel_id","value":"'1286673475565518878'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":0,"skipped":0,"passed":0,"unknown":0,"total":2},"items":[{"uid":"3f2fa8f8f6b0a70e","reportUrl":"https://Helgi-P.github.io/DiscordE2EAPITest/2//#testresult/3f2fa8f8f6b0a70e","status":"failed","statusDetails":"AssertionError: Тест упал: сообщение длиной 2000 символов не отправлено.","time":{"start":1730134753838,"stop":1730134753944,"duration":106}}]},"tags":["order(4)"]},"source":"c2472307e80b2910.json","parameterValues":["'1286673475565518878'"]}